<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ profile.name }} - Scheduling</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/centralfiles/css/scheduling.css">
  <link rel="stylesheet" href="/static/centralfiles/css/sidebar.css">
</head>
<body>
  <!-- Mobile Menu Toggle -->
  <button class="mobile-menu-toggle" id="mobileMenuToggle">
    <i>â˜°</i>
  </button>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo">Knowledge</div>
    
    <div class="nav-section">
      <div class="nav-title">Navigation</div>
      <a href="/files/" class="nav-link">
        <i>ğŸ“</i>
        <span>All Files</span>
      </a>
      <a href="/files/get/{{ profile.cfid }}" class="nav-link">
        <i>ğŸ‘¤</i>
        <span>Profile</span>
      </a>
      {% if profile.is_dianetics_pc %}
      <a href="/files/get/{{ profile.cfid }}/auditing" class="nav-link">
        <i>ğŸ§ </i>
        <span>PC Folder</span>
      </a>
      <a href="/files/get/{{ profile.cfid }}/sessions" class="nav-link">
        <i>ğŸ“‹</i>
        <span>Sessions</span>
      </a>
      <a href="/files/get/{{ profile.cfid }}/scheduling" class="nav-link active">
        <i>ğŸ—“ï¸</i>
        <span>Scheduling</span>
      </a>
      {% endif %}
      <a href="/files/get/{{ profile.cfid }}/agreements" class="nav-link">
        <i>ğŸ¤</i>
        <span>Agreements</span>
      </a>
      {% if profile.email_addr %}
      <a href="/files/get/{{ profile.cfid }}/mail" class="nav-link">
        <i>ğŸ“§</i>
        <span>Mail</span>
      </a>
      {% endif %}
    </div>
    
    <div class="nav-section">
      <div class="nav-title">Tools</div>
      <a href="/files/get/{{ profile.cfid }}/settings" class="nav-link">
        <i>âš™ï¸</i>
        <span>Settings</span>
      </a>
      <a href="/files/get/{{ profile.cfid }}/flags" class="nav-link">
        <i>ğŸš©</i>
        <span>Flags</span>
      </a>
    </div>
  </div>

  <div class="sidebar-overlay" id="sidebarOverlay"></div>

  <div class="main-content">
    <div class="page-header">
      <div class="page-title">
        <h1>{{ profile.name }} - Scheduling</h1>
        <p>A Full record of the schedule of {{ profile.name }}</p>
      </div>
      <div class="header-actions">
        <button id="save-btn" class="save-btn" disabled>ğŸ’¾ Save Changes</button>
        <button id="export-btn" class="btn btn-secondary">ğŸ“¥ Export</button>
      </div>
    </div>

    <div id="status-message" class="status-message" style="display: none;"></div>

    <div class="profile-header">
      <div class="profile-picture-section">
        <img 
          class="profile-image-large" 
          src="/api/files/{{ profile.cfid }}/profile_icon" 
          alt="{{ profile.name }}"
          onerror="this.src='data:image/svg+xml;base64,...'"
        >
      </div>
      <div class="profile-info">
        <h2 class="profile-name">{{ profile.name }}</h2>
        <p class="profile-occupation">{{ profile.occupation }}</p>
        <div class="profile-meta">
          <div class="meta-item"><i>ğŸ†”</i><span>CFID: {{ profile.cfid }}</span></div>
          <div class="meta-item"><i>ğŸ‘¤</i><span>Age: {{ profile.age }}</span></div>
          <div class="meta-item"><i>ğŸ”¤</i><span>Pronouns: {{ profile.pronouns.subject_pron }}/{{ profile.pronouns.objective_pron }}</span></div>
        </div>
      </div>
    </div>

    <div class="main-grid">
      <div class="left-column">
        <h3>Weekly Schedule</h3>

        <div class="filter-controls">
          <div class="filter-group">
            <label class="filter-label" for="day-filter">Day:</label>
            <select id="day-filter" class="filter-select">
              <option value="0">Monday</option>
              <option value="1">Tuesday</option>
              <option value="2">Wednesday</option>
              <option value="3">Thursday</option>
              <option value="4">Friday</option>
              <option value="5">Saturday</option>
              <option value="6">Sunday</option>
            </select>
          </div>

          <div class="filter-group">
            <label class="filter-label" for="room-filter">Selected Room:</label>
            <select id="room-filter" class="filter-select">
              <option value="all">All Rooms</option>
              <option value="room1">Room 1 - Main Auditing</option>
              <option value="room2">Room 2 - Co-audit</option>
              <option value="room3">Room 3 - Training</option>
              <option value="room4">Room 4 - Consultation</option>
              <option value="room5">Room 5 - Solo Processing</option>
            </select>
          </div>
        </div>

        <table class="timetable">
          <thead>
            <tr>
              <th id="time_th">Time</th>
              <th id="activity_th">Activity</th>
              <th id="auditor_th">Auditor</th>
            </tr>
          </thead>
          <tbody id="schedule-body">
            <tr>
              <td colspan="3" style="text-align: center; padding: 20px;">
                Loading schedule...
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="right-column">
      </div>
    </div>
  </div>

  <script>
    const FileCFID = parseInt("{{ profile.cfid }}");
  </script>
  <script src="/static/centralfiles/js/scheduling/schedule.js"></script>
  <script src="/static/centralfiles/js/shared/themecontrol.js"></script>
  <script src="/static/centralfiles/js/shared/sidebar.js"></script>
</body>
</html>
